%form.form-horizontal{'ng-controller'=>'ComboProductsController'}
  %fieldset
    %legend
      %span{'ng-hide'=>'currentProduct.isNew()'}
        =t('.update_header')
      %span{'ng-show'=>'currentProduct.isNew()'}
        =t('.create_header')
    .control-group
      %label.control-label{for: 'productName'}
        =t('name', scope:'activerecord.attributes.product')
      .controls
        %input{type:'text', name:'name',id:'productName',
              placeholder:"#{t('.name')}", 
              'ng-model'=>'currentProduct.attributes.name'}
        =render partial: 'application/error_paragraph', 
                locals:{prefix: 'currentProduct.', key: 'name'}
    .control-group
      %label.control-label{for:'productDescription'}
        =t('description', scope:'activerecord.attributes.product')
      .controls
        %textarea{name:'description', id:'productDescription',
              placeholder:"#{t('.description')}", 
              'ng-model'=>'currentProduct.attributes.description'}
        =render partial: 'application/error_paragraph', 
                locals:{prefix: 'currentProduct.', key: 'description'}
    .control-group
      %label.control-label{for:'productGroup'}
        =t('group', scope:'activerecord.attributes.product')
      .controls
        %span
          %select.chzn-select{name:'group', id:'productGroup',
                'data-placeholder'=>"#{t('.group')}", 
                chosen:'currentProduct.attributes.group', 
                'ng-model'=>'currentProduct.attributes.group'}
            -Product.localized_groups.each_pair do |group, translation|
              %option{name:"#{group}",value:"#{group}"}
                =translation
        =render partial: 'application/error_paragraph', locals:{prefix: 'currentProduct.', key: 'group'}
    .control-group{'ng-repeat'=>'consists in currentProduct.attributes.consists_of_basic_products'}
      %label.control-label
        %a{'ng-click'=>'dialog.openWith(currentProduct.basicProduct(consists))'} 
          {{currentProduct.basicProduct(consists).attributes.name}}
      .controls
        .input-append
          %input{type:'number', 'ng-model'=>'consists.amount', min: 1}
          %button.btn.btn-danger{type:'button',
            'ng-click'=>'currentProduct.removeBasicProduct(consists)'}
            %i.icon-remove
    .control-group
      %label.control-label{for:'addBasicProduct'}
        =t ('.add_basic_product')
      .controls
        %span
          %select.chzn-select{id:'addBasicProduct', 
            'data-placeholder'=>"#{t('.select_basic_product_from_list')}",
            'ng-model'=>'latestAddedBasicProductId', 
            'ng-change'=>'currentProduct.addBasicProduct(latestAddedBasicProductId)',
            'ng-options'=>'m.attributes.id as m.attributes.name for m in basicProducts()',
            chosen:"basicProducts().length"}
    .control-group
      .controls
        =render partial: 'application/status', locals: {prefix: 'currentProduct.'}
    .control-group
      .controls
        .btn-group
          %button.btn{'ng-click'=>'currentProduct.cancelChanges()'}
            =t('actions.cancel')
          %button.btn.btn-primary{'ng-click'=>'currentProduct.save()',
              'ng-disabled'=>'!currentProduct.hasUnsavedChanges()'}
            %span{'ng-show'=>'currentProduct.isNew()'}=t('.create')
            %span{'ng-hide'=>'currentProduct.isNew()'}=t('.update')

